$(function(){"use strict";function t(){u.attr("src","/pony/default"),$bgContainer.addClass("loading").find(".loading").css("background-image",'url("/loader/default")'),f.attr("src","/splat/default").off("load").on("load",function(){f.fadeIn(500,function(){$bgContainer.removeClass("loading")})})}function o(t){if(t=t.toLowerCase(),$slideout.attr("class")==="sort-"+t)return!1;var o=$slideoutInner.children(".tile:not([id])"),e=function(){$(this).insertAfter($slideoutInner.children(".tile:visible").last())};switch(t){case"colour":o.sort(function(t,o){var e=pusher.color($(t).data("color")),n=pusher.color($(o).data("color"));return e.hue()-n.hue()}),o.each(e);break;case"abc":o.sort(function(t,o){return $(t).data("longname").localeCompare($(o).data("longname"))}),o.each(e);break;case"newabc":var n=o.filter(".new").sort(function(t,o){return $(t).data("longname").localeCompare($(o).data("longname"))}),a=o.filter(":not(.new)").sort(function(t,o){return $(t).data("longname").localeCompare($(o).data("longname"))});n.each(e),a.each(e);break;default:return!1}$slideout.attr("class","sort-"+t),this.handler!==!1&&i("sort",t)}function e(t,o){var e=!1;if("string"==typeof t?-1===MLPNow.shortnames.indexOf(t):"undefined"==typeof MLPNow.Pony[t])return!1;if(t="string"==typeof t?MLPNow.Pony[MLPNow.shortnames.indexOf(t)]:MLPNow.Pony[t],m!==t.shortname){o||i("pony",e?"random":t.shortname),$bgContainer.addClass("loading").find(".loading").css("background-image",'url("/loader/'+t.color.substring(1)+'")');var n=0,a=$bgContainer.children(".background");a.fadeOut(500,function(){var o,e=$(this);o="pony"===e.attr("id")?"/pony/"+t.shortname:"/splat/"+t.textcolor.substring(1)+"/"+t.bgcolor.substring(1),e.attr("src",o).off("load error").on("load error",function(){return n>0?($("#pony,#splat").fadeIn(1e3,function(){$("#bgContainer").removeClass("loading")}),$(this).off("load error")):void n++})}),$(".dyn").removeClass(m).addClass(t.shortname),$slideoutInner.find(".heading").css("color",t.color),$slideoutInner.find('.tile.force-hover:not(".tile-'+(e?"random":t.shortname)+'")').removeClass("force-hover"),$slideoutInner.find('.tile:not(".force-hover").tile-'+(e?"random":t.shortname)).addClass("force-hover"),m=t.shortname}}function n(t,o){-1!==["at","12","24"].indexOf(t)&&(o||i("timeformat",t))}function a(t,o){var e=!("boolean"==typeof t?t:!MLPNow.pref.bottom);c.html(e?MLPNow.locale.show:MLPNow.locale.hide);var n=$(".tbh").stop();o?n[e?"hide":"show"]():n[e?"slideUp":"slideDown"]("fast"),d[(e?"remove":"add")+"Class"]("typcn-minus")[(e?"add":"remove")+"Class"]("typcn-plus"),o||i("bottom",!e)}function i(t,o,e){if(MLPNow.signedIn){p.stop().show();var n=window.MLPNow.pref[t];window.MLPNow.pref[t]!==o&&(window.MLPNow.pref[t]=o),clearInterval(window.prfchk),$.post("/prefupdate",{name:t,value:o},$.mkAjaxHandler(function(){if(!this.status)return window.MLPNow.pref[t]=n,$.Dialog.fail(!1,this.message);var a="typcn typcn-"+(this.status?"tick":"times"),i=p.children(".text").html();p.attr("data-status",!0).children(".text").addClass(a).html(this.message),"function"==typeof e&&e(t,o),setTimeout(function(){p.fadeOut(500,function(){p.removeAttr("data-status"),p.children(".text").removeClass(a).html(i),window.prfchk=setInterval(window.prfchkF,5e3)})},1e3)}))}}var r=!1;try{r=1===parseInt(localStorage.getItem("cookie_consent"),10)}catch(s){}$("#login").off("click").on("click",function(){var t=function(t){if(t){try{localStorage.setItem("cookie_consent",1)}catch(o){}var e=$.mk("div").attr("id","provider-selector").attr("class","align-center").append($.mk("p").text("Choose a service to sign in with"),$.mk("div").attr("class","providers").append($.mk("input").attr({"class":"btn deviantart",type:"button"}).val("DeviantArt"),$.mk("input").attr({"class":"btn google",type:"button"}).val("Google")));$.Dialog.info("Sign-in process",e,function(){$("#provider-selector").on("click","input[class]",function(){$.Dialog.wait(!1,"Redirecing you to "+this.value),window.location.href="/oauth/start/"+this.className.replace(/^btn\s/,"")})})}};r?t(!0):$.Dialog.confirm("EU Cookie Policy Notice",'In compliance with the <a href="http://ec.europa.eu/ipg/basics/legal/cookies/index_en.htm">EU Cookie Policy</a> we must inform you that our website will store cookies on your device to remember your logged in status between browser sessions.<br><br>If you would like to avoid these completly harmless pieces of information required to use this website, click "Decline" and continue browsing as a guest.<br><br>This warning will not appear again if you accept our use of persistent cookies.',["Accept","Decline"],t)}),$("#link").on("click",function(){var t=$.mk("form").attr("id","link-form").attr("class","align-center").append($.mk("p").text("Linking your different accounts will allow you to use the same settings across multiple external logins"),$.mk("p").text("Choose an account which you'd like to link to your current login"),$.mk("label").attr("class","providers").append($.mk("select").attr({name:"provider",required:!0}).append($.mk("option").attr({value:"",selected:!0}).text("(click here to select)").hide(),$.mk("option").attr("value","deviantart").text("DeviantArt"),$.mk("option").attr("value","google").text("Google"))),$.mk("label").append($.mk("input").attr({type:"checkbox",name:"migrate",disabled:!0}),$.mk("span").text("If target account exists, copy settings")));$.Dialog.request("Link acounts",t,"link-form","Link account",function(t){t.on("submit",function(o){o.preventDefault();var e=t.mkData();$.Dialog.wait(!1,"Redirecting you to "+t.find("select").children(":selected").text()),window.location.href="/link/start/"+(e.migrate?"migrate/":"")+e.provider})})}),MLPNow.timer.func=function(){var t=moment();$dateDisplay.html(t.format("LL"));var o=t.format("LTS");$timeDisplay.html(o),$("title").text(o+" - MLP Now")},MLPNow.timer.func(),MLPNow.timer.interval=setInterval(MLPNow.timer.func,500);var l=$("#toggle").on("click",a),c=l.children(".text"),d=l.children(".typcn");$("#slideoutTitle").find(".order-by").children().on("click",function(){o($(this).attr("id"),!0)}),$("#version").on("click",function(){}),$("#charsel").on("click",function(){$body.toggleClass("opened")}),$("#signout").off("click").on("click",function(){$.Dialog.confirm("Sign out","Are you sure you want to sign out?",function(t){t&&($.Dialog.wait(!1,"Signing out"),$.post("/signout",$.mkAjaxHandler(function(){return this.status?($.Dialog.success(!1,"You have been signed out successfully"),$.Dialog.wait(!1,"Reloading"),void setTimeout(function(){window.location.reload()},1e3)):$.Dialog.fail(!1,this.message)})))})});var u=$.mk("img").attr({id:"pony","class":"background"}),f=$.mk("img").attr({id:"splat","class":"background"});$bgContainer.append(f,u),t();var m;e(MLPNow.pref.pony,!0),n(MLPNow.pref.timeformat,!0),a(MLPNow.pref.bottom,!0);var h;new Konami(function(){MLPNow.shortnames.push("oc"),MLPNow.Pony.push({textcolor:"#AF70CC",bgcolor:"#D19FE3",color:"#C087D7",shortname:"oc"}),e("oc",!0),clearTimeout(window.prfchk),delete window.prfchk;var t=document.createElement("style");t.innerHTML=".oc {color:#C087D7}	/* The Ultimate OC */",$(t).insertAfter("head style:last")});$("#randomTile").on("click",function(){e(h)}).hover(function(){h=$.rnd(0,MLPNow.Pony.length-1);var t=MLPNow.Pony[h],o=$(this);o.css("background","linear-gradient(to bottom, "+t.bgcolor+" 0%,"+t.textcolor+" 100%)"),o.children("span").attr("class","pony-icon "+t.shortname);var e=t.longname.split(" ");"undefined"==typeof e[1]&&(e[1]="&nbsp;"),o.children("h4").html(e.join("<br>"))},function(){var t=$(this);t.css("background","linear-gradient(to bottom, #777 0%, #777 100%)"),t.children("h4").html(MLPNow.locale.randomTile),t.children("span").attr("class","pony-icon random")});var g=$slideoutInner.children(".tile:not([id])");g.on("click",function(){var t=$(this),o=t.data("shortname");if($(this).hasClass("force-hover")||m===o){$bgContainer.addClass("loading").find(".loading").css("background-image",'url("/loader/default")');var n=0,a=$bgContainer.children(".background");a.animate({opacity:0},500,function(){var t="/"+$(this).attr("id")+"/default";$(this).attr("src",t).off("load error").on("load error",function(){n++,2===n&&a.animate({opacity:1},500,function(){$("#bgContainer").removeClass("loading"),a.off("load error")})})}),$(".dyn").removeClass(m),$("#slideoutTitle .heading").css("color","#777"),g.removeClass("force-hover"),m=void 0,i("name","")}else e(o)});var p=$("#gui").children(".saveIndicator")});
//# sourceMappingURL=home.min.js.map
