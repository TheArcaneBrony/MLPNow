$(function(){"use strict";function e(){c.attr("src","/pony/default"),$bgContainer.addClass("loading").find(".loading").css("background-image",'url("/loader/default")'),d.attr("src","/splat/default").off("load").on("load",function(){d.fadeIn(500,function(){$bgContainer.removeClass("loading")})})}function o(e){if(e=e.toLowerCase(),$slideout.attr("class")==="sort-"+e)return!1;var o=$slideoutInner.children(".tile:not([id])"),t=function(){$(this).insertAfter($slideoutInner.children(".tile:visible").last())};switch(e){case"colour":o.sort(function(e,o){var t=pusher.color($(e).data("color")),n=pusher.color($(o).data("color"));return t.hue()-n.hue()}),o.each(t);break;case"abc":o.sort(function(e,o){return $(e).data("longname").localeCompare($(o).data("longname"))}),o.each(t);break;case"newabc":var n=o.filter(".new").sort(function(e,o){return $(e).data("longname").localeCompare($(o).data("longname"))}),a=o.filter(":not(.new)").sort(function(e,o){return $(e).data("longname").localeCompare($(o).data("longname"))});n.each(t),a.each(t);break;default:return!1}$slideout.attr("class","sort-"+e)}function t(e,o){var t=!1;if(-1===["boolean","undefined"].indexOf(typeof o)&&(t=!0,e=o),"string"==typeof e?-1===MLPNow.shortnames.indexOf(e):"undefined"==typeof MLPNow.Pony[e])return!1;if(e="string"==typeof e?MLPNow.Pony[MLPNow.shortnames.indexOf(e)]:MLPNow.Pony[e],u!==e.shortname){$bgContainer.addClass("loading").find(".loading").css("background-image",'url("/loader/'+e.color.substring(1)+'")');var n=0,a=$bgContainer.children(".background");a.fadeOut(500,function(){var o,t=$(this);o="pony"===t.attr("id")?"/pony/"+e.shortname:"/splat/"+e.textcolor.substring(1)+"/"+e.bgcolor.substring(1),t.attr("src",o).off("load error").on("load error",function(){return n>0?($("#pony,#splat").fadeIn(1e3,function(){$("#bgContainer").removeClass("loading")}),$(this).off("load error")):void n++})}),$(".dyn").removeClass(u).addClass(e.shortname),$slideoutInner.find(".heading").css("color",e.color),$slideoutInner.find('.tile.force-hover:not(".tile-'+(t?"random":e.shortname)+'")').removeClass("force-hover"),$slideoutInner.find('.tile:not(".force-hover").tile-'+(t?"random":e.shortname)).addClass("force-hover"),u=e.shortname}}function n(e){var o=l.text(),t=!isNaN(e)&&!e||o===MLPNow.locale.hide;l.html(t?MLPNow.locale.show:MLPNow.locale.hide),$(".tbh").slideToggle("fast"),s.toggleClass("typcn-minus typcn-plus")}var a=!1;try{a=1===parseInt(localStorage.getItem("cookie_consent"),10)}catch(i){}$("#login").off("click").on("click",function(){var e=($(this),function(e){if(e){try{localStorage.setItem("cookie_consent",1)}catch(o){}var t=$.mk("div").attr("id","provider-selector").attr("class","align-center").append($.mk("p").text("Choose a service to sign in with"),$.mk("div").attr("class","providers").append($.mk("input").attr({"class":"btn deviantart",type:"button"}).val("DeviantArt"),$.mk("input").attr({"class":"btn google",type:"button"}).val("Google")));$.Dialog.info("Sign-in process",t,function(){$("#provider-selector").on("click","input[class]",function(){$.Dialog.wait(!1,"Redirecing you to "+this.value),window.location.href="/oauth/start/"+this.className.replace(/^btn\s/,"")})})}});a?e(!0):$.Dialog.confirm("EU Cookie Policy Notice",'In compliance with the <a href="http://ec.europa.eu/ipg/basics/legal/cookies/index_en.htm">EU Cookie Policy</a> we must inform you that our website will store cookies on your device to remember your logged in status between browser sessions.<br><br>If you would like to avoid these completly harmless pieces of information required to use this website, click "Decline" and continue browsing as a guest.<br><br>This warning will not appear again if you accept our use of persistent cookies.',["Accept","Decline"],e)}),$("#link").on("click",function(){var e=$.mk("form").attr("id","link-form").attr("class","align-center").append($.mk("p").text("Linking your different accounts will allow you to use the same settings across multiple external logins"),$.mk("p").text("Choose an account which you'd like to link to your current login"),$.mk("label").attr("class","providers").append($.mk("select").attr({name:"provider",required:!0}).append($.mk("option").attr({value:"",selected:!0}).text("(click here to select)").hide(),$.mk("option").attr("value","deviantart").text("DeviantArt"),$.mk("option").attr("value","google").text("Google"))),$.mk("label").append($.mk("input").attr({type:"checkbox",name:"migrate",disabled:!0}),$.mk("span").text("If target account exists, copy settings")));$.Dialog.request("Link acounts",e,"link-form","Link account",function(e){e.on("submit",function(o){o.preventDefault();var t=e.mkData();$.Dialog.wait(!1,"Redirecting you to "+e.find("select").children(":selected").text()),window.location.href="/link/start/"+(t.migrate?"migrate/":"")+t.provider})})}),MLPNow.timer.func=function(){var e=moment();$dateDisplay.html(e.format("LL"));var o=e.format("LTS");$timeDisplay.html(o),$("title").text(o+" - MLP Now")},MLPNow.timer.func(),MLPNow.timer.interval=setInterval(MLPNow.timer.func,500);var r=$("#toggle").on("click",n),l=r.children(".text"),s=r.children(".typcn");$("#slideoutTitle").find(".order-by").children().on("click",function(){o($(this).attr("id"),!0)}),$("#version").on("click",function(){}),$("#charsel").on("click",function(){$body.toggleClass("opened")}),$("#signout").off("click").on("click",function(){$.Dialog.confirm("Sign out","Are you sure you want to sign out?",function(e){e&&($.Dialog.wait(!1,"Signing out"),$.post("/signout",$.mkAjaxHandler(function(){return this.status?($.Dialog.success(!1,"You have been signed out successfully"),$.Dialog.wait(!1,"Reloading"),void setTimeout(function(){window.location.reload()},1e3)):$.Dialog.fail(!1,this.message)})))})});var c=$.mk("img").attr({id:"pony","class":"background"}),d=$.mk("img").attr({id:"splat","class":"background"});$bgContainer.append(d,c),e();var u,f;new Konami(function(){MLPNow.shortnames.push("oc"),MLPNow.Pony.push({textcolor:"#AF70CC",bgcolor:"#D19FE3",color:"#C087D7",shortname:"oc"}),t.call({handler:!1},"oc"),clearTimeout(window.prfchk),delete window.prfchk;var e=document.createElement("style");e.innerHTML=".oc {color:#C087D7}	/* The Ultimate OC */",$(e).insertAfter("head style:last")});$("#randomTile").on("click",function(){t(f)}).hover(function(){f=$.rnd(0,MLPNow.Pony.length-1);var e=MLPNow.Pony[f],o=$(this);o.css("background","linear-gradient(to bottom, "+e.bgcolor+" 0%,"+e.textcolor+" 100%)"),o.children("span").attr("class","pony-icon "+e.shortname);var t=e.longname.split(" ");"undefined"==typeof t[1]&&(t[1]="&nbsp;"),o.children("h4").html(t.join("<br>")),o.children(".permalink").attr({title:o.children(".permalink").data("title")+e.shortname,href:"./?name="+e.shortname})},function(){var e=$(this);e.css("background","linear-gradient(to bottom, #777 0%, #777 100%)"),e.children("h4").html(MLPNow.locale.randomTile),e.children("span").attr("class","pony-icon random"),e.children(".permalink").removeAttr("title href")});var m=$slideoutInner.children(".tile:not([id])");m.on("click",function(){var e=$(this),o=e.data("shortname");if($(this).hasClass("force-hover")||u===o){$bgContainer.addClass("loading").find(".loading").css("background-image",'url("/loader/default")');var n=0,a=$bgContainer.children(".background");a.animate({opacity:0},500,function(){var e="/"+$(this).attr("id")+"/default";$(this).attr("src",e).off("load error").on("load error",function(){n++,2===n&&a.animate({opacity:1},500,function(){$("#bgContainer").removeClass("loading"),a.off("load error")})})}),$(".dyn").removeClass(u),$("#slideoutTitle .heading").css("color","#777"),m.removeClass("force-hover"),u=void 0}else t.call({handler:!0},o)})});
//# sourceMappingURL=home.min.js.map
