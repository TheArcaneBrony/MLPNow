$(function(){"use strict";function o(){c.attr("src","/pony/default"),$bgContainer.addClass("loading").find(".loading").css("background-image",'url("/loader/default")'),d.attr("src","/splat/default").off("load").on("load",function(){d.fadeIn(500,function(){$bgContainer.removeClass("loading")})})}function e(o){if(o=o.toLowerCase(),$slideout.attr("class")==="sort-"+o)return!1;var e=$slideoutInner.children(".tile:not([id])"),t=function(){$(this).insertAfter($slideoutInner.children(".tile:visible").last())};switch(o){case"colour":e.sort(function(o,e){var t=pusher.color($(o).data("color")),n=pusher.color($(e).data("color"));return t.hue()-n.hue()}),e.each(t);break;case"abc":e.sort(function(o,e){return $(o).data("longname").localeCompare($(e).data("longname"))}),e.each(t);break;case"newabc":var n=e.filter(".new").sort(function(o,e){return $(o).data("longname").localeCompare($(e).data("longname"))}),a=e.filter(":not(.new)").sort(function(o,e){return $(o).data("longname").localeCompare($(e).data("longname"))});n.each(t),a.each(t);break;default:return!1}$slideout.attr("class","sort-"+o)}function t(o,e){var t=!1;if(-1===["boolean","undefined"].indexOf(typeof e)&&(t=!0,o=e),"string"==typeof o?-1===MLPNow.shortnames.indexOf(o):"undefined"==typeof MLPNow.Pony[o])return!1;if(o="string"==typeof o?MLPNow.Pony[MLPNow.shortnames.indexOf(o)]:MLPNow.Pony[o],u!==o.shortname){$bgContainer.addClass("loading").find(".loading").css("background-image",'url("/loader/'+o.color.substring(1)+'")');var n=0,a=$bgContainer.children(".background");a.fadeOut(500,function(){var e,t=$(this);e="pony"===t.attr("id")?"/pony/"+o.shortname:"/splat/"+o.textcolor.substring(1)+"/"+o.bgcolor.substring(1),t.attr("src",e).off("load error").on("load error",function(){return n>0?($("#pony,#splat").fadeIn(1e3,function(){$("#bgContainer").removeClass("loading")}),$(this).off("load error")):void n++})}),$(".dyn").removeClass(u).addClass(o.shortname),$slideoutInner.find(".heading").css("color",o.color),$slideoutInner.find('.tile.force-hover:not(".tile-'+(t?"random":o.shortname)+'")').removeClass("force-hover"),$slideoutInner.find('.tile:not(".force-hover").tile-'+(t?"random":o.shortname)).addClass("force-hover"),u=o.shortname}}function n(o){var e=l.text(),t=!isNaN(o)&&!o||e===MLPNow.locale.hide;l.html(t?MLPNow.locale.show:MLPNow.locale.hide),$(".tbh").slideToggle("fast"),s.toggleClass("typcn-minus typcn-plus")}var a=!1;try{a=1===parseInt(localStorage.getItem("cookie_consent"),10)}catch(r){}$("#login").off("click").on("click",function(){var o=$(this),e=function(e){if(e){try{localStorage.setItem("cookie_consent",1)}catch(t){}o.attr("disabled",!0);var n=$.mk("div").attr("id","provider-selector").attr("class","align-center").append($.mk("p").text("Choose a service to sign in with"),$.mk("div").append($.mk("button").attr("class","deviantart").text("DeviantArt")));$.Dialog.info("Sign-in process",n,function(){$("#provider-selector").on("click","button[class]",function(){window.location.href="/oauth/start/"+this.className})})}};a?e(!0):$.Dialog.confirm("EU Cookie Policy Notice",'In compliance with the <a href="http://ec.europa.eu/ipg/basics/legal/cookies/index_en.htm">EU Cookie Policy</a> we must inform you that our website will store cookies on your device to remember your logged in status between browser sessions.<br><br>If you would like to avoid these completly harmless pieces of information required to use this website, click "Decline" and continue browsing as a guest.<br><br>This warning will not appear again if you accept our use of persistent cookies.',["Accept","Decline"],e)}),MLPNow.timer.func=function(){var o=moment();$dateDisplay.html(o.format("LL"));var e=o.format("LTS");$timeDisplay.html(e),$("title").text(e+" - MLP Now")},MLPNow.timer.func(),MLPNow.timer.interval=setInterval(MLPNow.timer.func,500);var i=$("#toggle").on("click",n),l=i.children(".text"),s=i.children(".typcn");$("#slideoutTitle").find(".order-by").children().on("click",function(){e($(this).attr("id"),!0)}),$("#version").on("click",function(){}),$("#charsel").on("click",function(){$body.toggleClass("opened")}),$("#signout").off("click").on("click",function(){$.Dialog.confirm("Sign out","Are you sure you want to sign out?",function(o){o&&($.Dialog.wait(!1,"Signing out"),$.post("/signout",$.mkAjaxHandler(function(){return this.status?($.Dialog.success(!1,this.message),void setTimeout(function(){window.location.reload()},1e3)):$.Dialog.fail(!1,this.message)})))})});var c=$.mk("img").attr({id:"pony","class":"background"}),d=$.mk("img").attr({id:"splat","class":"background"});$bgContainer.append(d,c),o();var u,f;new Konami(function(){MLPNow.shortnames.push("oc"),MLPNow.Pony.push({textcolor:"#AF70CC",bgcolor:"#D19FE3",color:"#C087D7",shortname:"oc"}),t.call({handler:!1},"oc"),clearTimeout(window.prfchk),delete window.prfchk;var o=document.createElement("style");o.innerHTML=".oc {color:#C087D7}	/* The Ultimate OC */",$(o).insertAfter("head style:last")});$("#randomTile").on("click",function(){t(f)}).hover(function(){f=$.rnd(0,MLPNow.Pony.length-1);var o=MLPNow.Pony[f],e=$(this);e.css("background","linear-gradient(to bottom, "+o.bgcolor+" 0%,"+o.textcolor+" 100%)"),e.children("span").attr("class","pony-icon "+o.shortname);var t=o.longname.split(" ");"undefined"==typeof t[1]&&(t[1]="&nbsp;"),e.children("h4").html(t.join("<br>")),e.children(".permalink").attr({title:e.children(".permalink").data("title")+o.shortname,href:"./?name="+o.shortname})},function(){var o=$(this);o.css("background","linear-gradient(to bottom, #777 0%, #777 100%)"),o.children("h4").html(MLPNow.locale.randomTile),o.children("span").attr("class","pony-icon random"),o.children(".permalink").removeAttr("title href")});var h=$slideoutInner.children(".tile:not([id])");h.on("click",function(){var o=$(this),e=o.data("shortname");if($(this).hasClass("force-hover")||u===e){$bgContainer.addClass("loading").find(".loading").css("background-image",'url("/loader/default")');var n=0,a=$bgContainer.children(".background");a.animate({opacity:0},500,function(){var o="/"+$(this).attr("id")+"/default";$(this).attr("src",o).off("load error").on("load error",function(){n++,2===n&&a.animate({opacity:1},500,function(){$("#bgContainer").removeClass("loading"),a.off("load error")})})}),$(".dyn").removeClass(u),$("#slideoutTitle .heading").css("color","#777"),h.removeClass("force-hover"),u=void 0}else t.call({handler:!0},e)})});
//# sourceMappingURL=home.min.js.map
