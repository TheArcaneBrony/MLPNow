function updatePref(e,t){var o=$("#main .saveIndicator"),a=this;if(loggedin){$("#main .saveIndicator").show();var n=window.MLPNow.pref[e];window.MLPNow.pref[e]!==t&&(window.MLPNow.pref[e]=t),clearInterval(window.prfchk),$.ajax({type:"POST",url:"prefupdate",data:{name:e,value:t},success:function(r){if("string"==typeof r)return console.log(r)===$(window).trigger("ajaxerror");var l="typcn typcn-"+(r.status?"tick":"times"),s=o.children(".text").html();o.attr("data-status",r.status).children(".text").addClass(l).html(r.message),r.status||(window.MLPNow.pref[e]=n),"function"==typeof a.callback&&a.callback(e,t),setTimeout(function(){o.fadeOut(500,function(){o.removeAttr("data-status"),o.children(".text").removeClass(l).html(s),window.prfchk=setInterval(window.prfchkF,5e3)})},1e3)}})}}function changeBGImage(e,t){var o=window.tempName,a=!1,n=MLPNow.Pony,r=this;if(-1==["boolean","undefined"].indexOf(typeof t)&&(a=!0,e=t,delete t),"string"==typeof e?-1==n.shortNames.indexOf(e):"undefined"==typeof n.list[e])return!1;if(e="string"==typeof e?n.list[n.shortNames.indexOf(e)]:n.list[e],o!==e.shortName){$(".datgrey").removeClass("datgrey"),r.handler!==!1&&updatePref.call({callback:r.callback},"name",a?"random":e.shortName),"undefined"==typeof window.prfchk&&"undefined"!=typeof window.prfchkF&&(window.prfchk=setInterval(window.prfchkF,5e3)),$("#bgContainer .loading").css("background-image",'url("'+RELPATH+"loader/"+e.color.substring(1)+'")'),$("#ponyscreen").filter(":visible").fadeOut(800);var l=0;$("#bgContainer:not(.loading)").addClass("loading"),$("#pony,#splat").fadeOut(500,function(){var t;t="pony"==$(this).attr("id")?RELPATH+"pony/"+e.shortName:RELPATH+"splat/"+e.textcolor.substring(1)+"/"+e.bgcolor.substring(1),$(this).attr("src",t).off("load error").on("load error",function(){return l>0?($("#pony,#splat").fadeIn(1e3,function(){$("#bgContainer").removeClass("loading")}),$(this).off("load error")):void l++})}),$(".dyn").removeClass(o).addClass(e.shortName),$("#pinNotify").removeClass(o).addClass(e.shortName).css("border-bottom","3px solid "+e.color),$("#slideoutInner .heading").css("color",e.color),$("#slideout").css("border-right","3px solid "+e.color),$('#slideoutInner .tile.force-hover:not(".tile-'+(a?"random":e.shortName)+'")').removeClass("force-hover"),$('#slideoutInner .tile:not(".force-hover").tile-'+(a?"random":e.shortName)).addClass("force-hover"),window.tempName=e.shortName}}function ampm(e){-1!==["at","12","24"].indexOf(e)&&(this.handler===!1?MLPNow.pref.timeformat=e:updatePref("timeformat",e))}function bottom(e){var t=$("#toggle span.text").text();isNaN(e)?(t==MLPNow.locale.hide?($("#toggle span.text").html(MLPNow.locale.show),$("#toggle span.typcn.typcn-minus").removeClass("typcn-minus").addClass("typcn-plus"),updatePref("bottom",0)):t==MLPNow.locale.show&&($("#toggle span.text").html(MLPNow.locale.hide),$("#toggle span.typcn.typcn-plus").removeClass("typcn-plus").addClass("typcn-minus"),updatePref("bottom",1)),$(".tbh").toggle("slow")):e?($("#toggle span.text").html(MLPNow.locale.hide),$("#toggle span.typcn.typcn-plus").removeClass("typcn-plus").addClass("typcn-minus"),$(".tbh").slideDown()):($("#toggle span.text").html(MLPNow.locale.show),$("#toggle span.typcn.typcn-minus").removeClass("typcn-minus").addClass("typcn-plus"),$(".tbh").slideUp())}function sort(e){if(e=e.toLowerCase(),$("#slideout").attr("class")=="sort-"+e)return!1;var t=$("#slideoutInner .tile:not([id])"),o=function(e,t){$(this).insertAfter($("#slideoutInner .tile:visible").last())};switch(e){case"colour":t.sort(function(e,t){return colorA=pusher.color($(e).data("color")),colorB=pusher.color($(t).data("color")),colorA.hue()-colorB.hue()}),t.each(o);break;case"abc":t.sort(function(e,t){return $(e).data("longname").localeCompare($(t).data("longname"))}),t.each(o);break;case"newabc":var a=t.filter(".new").sort(function(e,t){return $(e).data("longname").localeCompare($(t).data("longname"))}),n=t.filter(":not(.new)").sort(function(e,t){return $(e).data("longname").localeCompare($(t).data("longname"))});a.each(o),n.each(o);break;default:return!1}$("#slideout").attr("class","sort-"+e),this.handler!==!1&&updatePref("sort",e)}$(document).ready(function(){var e;$("#randomTile").on("click",function(){changeBGImage(e)}).hover(function(){e=$.rnd(0,MLPNow.Pony.shortNames.length-1);var t=MLPNow.Pony.list[e],o=$(this);o.css("background","linear-gradient(to bottom, "+t.bgcolor+" 0%,"+t.textcolor+" 100%)"),o.children("span").attr("class","pony-icon "+t.shortName);var a=t.longName.split(" ");"undefined"==typeof a[1]&&(a[1]="&nbsp;"),o.children("h4").html(a.join("<br>")),o.children(".permalink").attr({title:o.children(".permalink").data("title")+t.shortName,href:"./?name="+t.shortName})},function(){var e=$(this);e.css("background","linear-gradient(to bottom, #777 0%, #777 100%)"),e.children("h4").html(MLPNow.locale.randomTile),e.children("span").attr("class","pony-icon random"),e.children(".permalink").removeAttr("title href")}),$("#slideoutInner .tile:not([id])").on("click",function(){var e=$(this).data("shortname");if($(this).hasClass("force-hover")||window.tempName===e){$("#bgContainer:not(.loading)").addClass("loading"),$("#bgContainer .loading").css("background-image",'url("'+RELPATH+'loader/default")');var t=0;$("#pony,#splat").animate({opacity:0},500,function(){var e=RELPATH+$(this).attr("id")+"/default";$(this).attr("src",e).off("load error").on("load error",function(){return t>0&&$("#pony,#splat").animate({opacity:1},500,function(){$("#bgContainer").removeClass("loading")}),t++,$(this).off("load error")})}),$(".dyn").removeClass(tempName).addClass("datgrey"),$("#lang_title .ddTitleText").removeClass(tempName).addClass("datgrey"),$("#pinNotify").removeClass(tempName).addClass("datgrey").css("border-bottom","3px solid #777"),$(".dd .ddChild a.selected, #ponyscreen .heading").css("color","#777"),$("#ponyscreen .tile.force-hover").removeClass("force-hover");try{return window.external.msIsSiteMode()&&reload!==!1&&window.location.reload(),!0}catch(o){}$('meta[name="msapplication-navbutton-color"]').attr("content","#777"),window.tempName="",updatePref("name","")}else changeBGImage.call({handler:!0},e)}).find(".permalink").on("click",function(e){var t=$(this);return setTimeout(function(){window.location.href=t.attr("href")},1),!1}),$("#differentTile").on("click",function(){return changeBGImage("random"),!1});var t={sort:sort,bottom:bottom,timeformat:ampm,name:changeBGImage},o=function(){$.post(RELPATH+"prefcheck","name=*",function(e){e.status&&$.each(e.value,function(e,o){"function"==typeof t[e]&&t[e].call({handler:!1},o)})})};window.prfchkF=o,window.prfchk=setInterval(o,5e3),o();new Konami(function(){MLPNow.Pony.shortNames.push("oc"),MLPNow.Pony.list.push({textcolor:"#AF70CC",bgcolor:"#D19FE3",color:"#C087D7",shortName:"oc"}),changeBGImage.call({handler:!1},"oc"),clearTimeout(window.prfchk),delete window.prfchk;var e=document.createElement("style");e.innerHTML=".oc {color:#C087D7}	/* The Ultimate OC */",$(e).insertAfter("head style:last")})});
//# sourceMappingURL=formembers.min.js.map
